# 山姆闪购超市 - Web 前端

山姆闪购超市的客户端购物网站。

## 概述

这是主要的购物网站，客户可以在此浏览商品、管理购物车并下单。使用 React、Vite 和 TypeScript 构建，提供快速响应的购物体验。

## 功能特性

- **商品浏览**：搜索、筛选和按类别浏览商品
- **购物车**：添加/删除商品，实时计算更新数量
- **用户账户**：注册、登录和管理个人信息
- **订单管理**：下单和查看订单历史
- **商品详情**：查看详细的商品信息和图片展示
- **响应式设计**：优化适配桌面和移动设备

## 技术栈

- **框架**：React 18 + TypeScript
- **构建工具**：Vite
- **样式**：Tailwind CSS + HeroUI 组件库
- **状态管理**：Zustand
- **路由**：React Router v6
- **HTTP 客户端**：Axios
- **图标**：Lucide React
- **表单**：React Hook Form + Zod 验证

## 架构设计

### 核心架构特点

1. **现代化技术栈**：采用 React 19、TypeScript、Vite 和 Tailwind CSS v4 最新技术
2. **类型安全**：全面使用 TypeScript，开启严格模式确保代码质量
3. **状态管理模式**：使用 Zustand 管理局部和全局状态，支持持久化存储
4. **API 通信模式**：集中式请求处理，配合拦截器实现统一管理
5. **安全机制**：基于 JWT 的身份认证，自动化令牌管理
6. **用户体验**：完善的加载状态、错误边界和响应式设计
7. **开发体验**：路径别名、热重载、TypeScript 智能提示
8. **可扩展性**：模块化架构，关注点分离

### 路由架构

使用 **React Router v6** 实现单页应用路由：

- **懒加载**：所有页面组件使用 `React.lazy()` 实现按需加载
- **布局模式**：通过嵌套路由和 Layout 组件实现统一布局
- **受保护路由**：使用 ProtectedRoute 组件实现权限控制
- **404 处理**：通配符路由捕获所有未匹配路径

### 状态管理架构

**Zustand 状态管理**：

1. **购物车状态** (`useCart`)：
   - 持久化到 localStorage
   - 支持商品变体（尺寸、颜色）
   - 库存验证和数量管理
   - 计算属性（商品数量、总金额）

2. **认证状态** (`useAuth`)：
   - JWT 令牌管理
   - 用户信息缓存
   - 登录状态持久化

### API 服务层

**请求工具** (`utils/request.ts`)：

- 基于 Axios 的 HTTP 客户端
- 请求拦截器自动注入 JWT 令牌
- 统一的错误处理机制
- 支持文件上传进度追踪
- 支持文件下载功能

### 组件架构

- **原子化设计**：基础 UI 组件独立封装
- **组合模式**：通过组件组合构建复杂界面
- **容器组件**：统一的页面容器布局
- **业务组件**：封装特定业务逻辑的组件

### 性能优化

1. **代码分割**：基于路由的自动代码分割
2. **懒加载**：组件级别的延迟加载
3. **状态优化**：Zustand 浅比较减少重渲染
4. **资源优化**：Vite 自动依赖预构建
5. **React 优化**：使用 `useCallback` 和 `useMemo`
6. **无限滚动**：使用 Intersection Observer 实现

### 工具函数

**格式化工具** (`utils/format.ts`)：
- 价格、日期、数字格式化
- 国际化支持（Intl API）
- 隐私保护格式化（手机号、身份证脱敏）

**验证工具** (`utils/validation.ts`)：
- 完整的表单验证函数集
- 密码强度计算
- 基于规则的统一验证系统

### 构建配置

**Vite 配置**：
- React 插件支持 Fast Refresh
- 路径别名 (`@` 映射到 `./src`)
- Tailwind CSS 插件集成
- 生产环境优化配置

**TypeScript 配置**：
- 严格模式确保类型安全
- 模块解析优化
- JSX 转换配置

## 环境要求

- Node.js（v18 或更高版本）
- pnpm 包管理器

## 快速开始

1. 安装依赖：
   ```bash
   pnpm install
   ```

2. 启动开发服务器：
   ```bash
   pnpm dev
   ```

   应用将在 `http://localhost:3200` 上运行

3. 构建生产版本：
   ```bash
   pnpm build
   ```

4. 预览生产构建：
   ```bash
   pnpm preview
   ```

## 项目结构

```
web/
├── src/
│   ├── components/     # 可复用的 UI 组件
│   ├── hooks/          # 自定义 React hooks
│   ├── lib/            # 工具函数和配置
│   ├── pages/          # 页面组件
│   ├── services/       # API 服务层
│   ├── stores/         # Zustand 状态存储
│   └── types/          # TypeScript 类型定义
├── public/             # 静态资源
└── index.html          # 入口 HTML 文件
```

## 主要页面

- **首页** (`/`)：展示特色商品和分类
- **商品列表** (`/products`)：商品列表页，支持搜索和筛选
- **商品详情** (`/products/:id`)：单个商品的详细信息
- **购物车** (`/cart`)：购物车管理
- **结算** (`/checkout`)：下单流程
- **个人中心** (`/profile`)：用户账户管理
- **订单** (`/orders`)：订单历史和跟踪

## 环境变量

在根目录创建 `.env` 文件：

```env
VITE_API_URL=http://localhost:3000
```

## 可用脚本

- `pnpm dev` - 启动开发服务器
- `pnpm build` - 构建生产版本
- `pnpm preview` - 预览生产构建
- `pnpm lint` - 运行 ESLint
- `pnpm type-check` - 运行 TypeScript 类型检查

## API 集成

Web 应用连接到后端 API 服务（默认运行在 3000 端口）。启动 Web 应用前请确保 API 服务正在运行。

## 开发规范

1. 遵循现有的代码风格和约定
2. 所有新代码使用 TypeScript
3. 确保所有组件都有正确的类型定义
4. 在桌面和移动视图上进行测试
5. 提交前运行代码检查和类型检查